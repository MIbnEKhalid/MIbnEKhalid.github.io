<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Enter and Read Data</title>
</head>
<body>
    <h1>Enter Data</h1>
    <form id="dataForm">
        <label for="name">Name:</label>
        <input type="text" id="name" name="name"><br><br>
        <label for="age">Age:</label>
        <input type="number" id="age" name="age"><br><br>
        <label for="gender">Gender:</label>
        <select id="gender" name="gender">
            <option value="male">Male</option>
            <option value="female">Female</option>
            <option value="other">Other</option>
        </select><br><br>
        <input type="submit" value="Submit" class="sub" id="submit">
    </form>

    <h1>Read Data</h1>
    <form id="readForm">
        <label for="searchName">Enter Name to Retrieve Data:</label>
        <input type="text" id="searchName" name="searchName">
        <button type="button" id="searchButton">Search</button>
    </form>
    <div id="userData"></div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.19.1/firebase-app.js";
        import { getDatabase, ref, set, get, child } from "https://www.gstatic.com/firebasejs/9.19.1/firebase-database.js";

        const firebaseConfig = {
            apiKey: "AIzaSyA0dQmm3-Ku1vFgumA77S9abQ-WdZvP6C8",
            authDomain: "read-d6f2b.firebaseapp.com",
            databaseURL: "https://read-d6f2b-default-rtdb.firebaseio.com",
            projectId: "read-d6f2b",
            storageBucket: "read-d6f2b.appspot.com",
            messagingSenderId: "393601857791",
            appId: "1:393601857791:web:a29aa96421c98a596e34ca"
        };

        const app = initializeApp(firebaseConfig);
        const db = getDatabase(app);

        // Function to submit data
        function submitData(e) {
            e.preventDefault();

            const name = document.getElementById('name').value;
            const age = document.getElementById('age').value;
            const gender = document.getElementById('gender').value;

            set(ref(db, 'user/' + name), {
                username: name,
                email: age,
                PhoneNumber: gender
            }).then(() => {
                alert("Data submitted successfully!");
                document.getElementById('dataForm').reset();
            }).catch((error) => {
                console.error("Error writing document: ", error);
            });
        }

        // Function to read data
        function readData() {
            const searchName = document.getElementById('searchName').value;

            get(child(ref(db, 'user'), searchName)).then((snapshot) => {
                if (snapshot.exists()) {
                    const userData = snapshot.val();
                    document.getElementById('userData').innerHTML = `
                        <p><strong>Name:</strong> ${userData.username}</p>
                        <p><strong>Email:</strong> ${userData.email}</p>
                        <p><strong>Phone Number:</strong> ${userData.PhoneNumber}</p>
                    `;
                } else {
                    document.getElementById('userData').innerHTML = "No data found for this name.";
                }
            }).catch((error) => {
                console.error("Error reading document: ", error);
            });
        }

        // Attach event listener to the submit button
        document.getElementById('submit').addEventListener('click', submitData);

        // Attach event listener to the search button
        document.getElementById('searchButton').addEventListener('click', readData);
    </script>
</body>
</html>
